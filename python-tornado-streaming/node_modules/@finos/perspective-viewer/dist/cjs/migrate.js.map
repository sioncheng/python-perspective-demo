{
  "version": 3,
  "sources": ["../../src/ts/migrate.ts", "../../src/ts/migrate/semver.ts", "../../src/ts/migrate/0-0-0.ts", "../../src/ts/migrate/2-6-1.ts", "../../src/ts/migrate/2-8-0.ts"],
  "sourcesContent": ["// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport Semver from \"./migrate/semver\";\nimport migrate_0_0_0 from \"./migrate/0-0-0\";\nimport migrate_2_6_1 from \"./migrate/2-6-1\";\nimport migrate_2_8_0 from \"./migrate/2-8-0\";\nimport packageJSON from \"@finos/perspective/package.json\" assert { type: \"json\" };\nimport { PerspectiveViewerConfig } from \"./viewer\";\n\nconst PKG_VERSION = packageJSON.version;\n\n/**\n * A migration utility for `@finos/perspective-viewer` and\n * `@finos/perspective-workspace` persisted state objects.  If you have an\n * application which persists tokens returned by the `.save()` method of a\n * Perspective Custom Element, and you want to upgrade Perspective to the latest\n * version, this module is for you!  You know who you are!\n *\n * Say you have a `<perspective-viewer>` Custom Element from\n * `@finos/perspective-viewer>=0.8.3`, and have persisted an arbitrary persistence\n * token object:\n *\n * ```javascript\n * const old_elem = document.querySelector(\"perspective-viewer\");\n * const old_token = await old_elem.save();\n * ```\n *\n * To migrate this token to the version of `@finos/perspective-migrate` itself:\n *\n * ```javascript\n * import {convert} from \"@finos/perspective-viewer`;\n *\n * // ...\n *\n * const new_elem = document.querySelector(\"perspective-viewer\");\n * const new_token = convert(old_token);\n * await new_elem.restore(new_token);\n * ```\n *\n * `convert` can also be imported in node for converting persisted tokens\n * outside the browser.\n *\n * ```javascript\n * const {convert} = require(\"@finos/perspective-viewer/dist/cjs/migrate.js\");\n * ```\n * @param old the layout to convert, in `<perspective-viewer>` or\n * `<perspective-workspace>` format.\n * @param options a `PerspectiveConvertOptions` object specifying the convert\n * options for this call.\n * @returns a layout for either `<perspective-viewer>` or\n * `<perspective-workspace>`, updated to the perspective version of this\n * script's package.\n */\nexport function convert(\n    old: InitialConfig | ArrayBuffer | string,\n    {\n        warn = true,\n        verbose = false,\n        replace_defaults = false,\n    }: PerspectiveConvertOptions = {}\n): PerspectiveViewerConfig | ArrayBuffer | string {\n    if (typeof old === \"object\" && !(old instanceof ArrayBuffer)) {\n        const copy = JSON.parse(JSON.stringify(old));\n        let options = {\n            warn: verbose ? true : warn,\n            verbose,\n            replace_defaults,\n        };\n        if (\"viewers\" in copy && \"detail\" in copy) {\n            return migrate_workspace(copy, options);\n        } else {\n            return migrate_viewer(copy, false, options);\n        }\n    } else {\n        return old;\n    }\n}\n\ntype InitialConfig = Record<string, unknown>;\n\nexport type PerspectiveConvertOptions = {\n    warn?: boolean;\n    verbose?: boolean;\n    replace_defaults?: boolean;\n    omit_attributes?: boolean;\n};\n\nexport type Options = PerspectiveConvertOptions & { version_chain?: string[] };\n\n/**\n * Migrate a layout for `<perspective-workspace>`\n * @param old - TODO this should get a WorkspaceConfig type\n * @param options\n * @returns\n */\nfunction migrate_workspace(old: any, options: Options) {\n    for (const key in old.viewers) {\n        old.viewers[key] = migrate_viewer(old.viewers[key], true, options);\n        if (!(\"master\" in old.viewers[key])) {\n            old.viewers[key].master = false;\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective missing attribute \"master\" set to default`\n                );\n            }\n        }\n\n        if (!(\"linked\" in old.viewers[key])) {\n            old.viewers[key].linked = false;\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective missing attribute \"linked\" set to default`\n                );\n            }\n        }\n    }\n\n    return old;\n}\n\n/**\n * Migrate a layout for `<perspective-viewer>`\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_viewer(old: any, omit_attributes: boolean, options: Options) {\n    old.version = old.version ? new Semver(old.version) : new Semver(\"0.0.0\");\n    options.omit_attributes = omit_attributes;\n    // This array details the \"next version\" in line. It begins with 2.6.1\n    // and continues until the latest migration. Then, the current package\n    // version is appended to the end, in case the latest migration\n    // is older than the latest release. Each migration will shift the array.\n    // Note that because we will be working with the latest version on master,\n    // and those versions will need to update from themselves to themselves,\n    // migration scripts must be idempotent.\n    options.version_chain = [\"2.6.1\", \"2.7.1\", \"2.8.0\"];\n    options.version_chain.push(PKG_VERSION);\n    let res = chain(\n        old,\n        [\n            migrate_0_0_0,\n            migrate_2_6_1,\n            migrate_2_8_0,\n            assure_latest,\n            (old) => {\n                return {\n                    ...old,\n                    version: old.version.to_string(),\n                };\n            },\n        ],\n        options\n    );\n    if (options.verbose) {\n        console.log(\"Final result -> \", res);\n    }\n    return res;\n}\n\nfunction assure_latest(old: { version: Semver }) {\n    if (old.version.gt(PKG_VERSION)) {\n        throw new Error(\"Migrated version is newer than package version!\");\n    } else {\n        old.version = new Semver(PKG_VERSION);\n        return old;\n    }\n}\n\n/**\n * Chains functions of `args` and apply to `old`\n * @param old\n * @param args\n * @param options\n * @returns\n */\nexport function chain(old: object, args: Function[], options: Options) {\n    for (const arg of args) {\n        old = arg(old, options);\n    }\n\n    return old;\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nfunction* null_iter() {\n    while (true) yield null;\n}\nexport default class Semver {\n    major: number;\n    minor: number;\n    patch: number;\n    build?: {\n        major: number;\n        minor: number;\n        patch: number;\n    };\n\n    constructor(ver: string | Semver) {\n        if (typeof ver !== \"string\") {\n            this.major = ver.major;\n            this.minor = ver.minor;\n            this.patch = ver.patch;\n            this.build = ver.build;\n            return this;\n        }\n\n        let regex = /(\\d+)\\.(\\d+)\\.(\\d+)(\\+.+)?/;\n        let [_ver, major, minor, patch, build_str] = ver.match(regex);\n        let [_build, build_major, build_minor, build_patch] =\n            build_str?.match(regex) ?? null_iter();\n        let build =\n            build_major && build_minor && build_patch\n                ? {\n                      major: Number(build_major),\n                      minor: Number(build_minor),\n                      patch: Number(build_patch),\n                  }\n                : null;\n\n        this.major = Number(major);\n        this.minor = Number(minor);\n        this.patch = Number(patch);\n        this.build = build;\n        return this;\n    }\n\n    to_string() {\n        return `${this.major}.${this.minor}.${this.patch}`;\n    }\n\n    gt(val: string | Semver) {\n        let right = new Semver(val);\n        return (\n            this.major > right.major ||\n            (this.major === right.major && this.minor > right.minor) ||\n            (this.major === right.major &&\n                this.minor === right.minor &&\n                this.patch > right.patch)\n        );\n    }\n    eq(val: string | Semver) {\n        let right = new Semver(val);\n        return (\n            this.major === right.major &&\n            this.minor == right.minor &&\n            this.patch == right.patch\n        );\n    }\n\n    ge(val: string | Semver) {\n        let right = new Semver(val);\n        return this.eq(right) || this.gt(right);\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport { Options, chain } from \"../migrate\";\nimport Semver from \"./semver\";\n\n/**\n * Migrates all viewer configs older than version 1.0.0.\n * @param old\n * @param omit_attributes\n * @param options\n * @returns The migrated viewer.\n */\nexport default function migrate_0_0_0(old: any, options: Options) {\n    const next_version = options.version_chain.shift();\n    if (old.version?.gt(next_version)) {\n        return old;\n    } else {\n        if (options.warn) {\n            console.warn(`Migrating Legacy -> ${next_version}`);\n        }\n    }\n    let res = chain(\n        old,\n        [\n            migrate_group_by,\n            migrate_split_by,\n            migrate_filters,\n            migrate_expressions,\n            options.replace_defaults ? migrate_nulls : (x) => x,\n            migrate_plugins,\n            migrate_plugin_config,\n            migrate_title,\n            migrate_name_title_workspace,\n            options.omit_attributes\n                ? migrate_attributes_workspace\n                : migrate_attributes_viewer,\n            (old) => {\n                old.version = new Semver(\"0.0.0\");\n                return old;\n            },\n        ],\n        options\n    );\n\n    if (options.verbose) {\n        console.log(res);\n    }\n    return res;\n}\n\n/**\n * Replace `null` properties with defaults.  This is not strictly behavioral,\n * as new `<perspective-viewer>` treats `null` as an explicit \"reset to default\"\n * instruction.  However, it may be necessary to ensure that `.save()` returns\n * identical results to `convert()`, which may be desirable when migrating a\n * database of layouts.\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_nulls(old, options) {\n    for (const key of [\"group_by\", \"split_by\", \"filter\", \"sort\"]) {\n        if (old[key] === null) {\n            old[key] = [];\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective missing attribute \"${key}\" set to default\"`\n                );\n            }\n        }\n\n        if (\"aggregates\" in old && old.aggregates === null) {\n            old.aggregates = {};\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective missing attribute \"aggregates\" set to default\"`\n                );\n            }\n        }\n    }\n\n    return old;\n}\n\n/**\n * Helper for alias-replacement migrations\n * @param original\n * @param aliases\n * @returns\n */\nfunction _migrate_field_aliases(original, aliases) {\n    return function (old, options) {\n        let count = 0;\n        for (const pivot of aliases) {\n            if (pivot in old) {\n                if (count++ > 0) {\n                    throw new Error(`Duplicate \"${original}\" fields`);\n                }\n\n                old[original] = old[pivot];\n                if (pivot !== original) {\n                    delete old[pivot];\n                    if (options.warn) {\n                        console.warn(\n                            `Deprecated perspective attribute \"${pivot}\" renamed \"${original}\"`\n                        );\n                    }\n                }\n            }\n        }\n\n        return old;\n    };\n}\n\n/**\n * Migrate `group_by` field aliases\n */\nconst migrate_group_by = _migrate_field_aliases(\"group_by\", [\n    \"group_by\",\n    \"row_pivots\",\n    \"row-pivot\",\n    \"row-pivots\",\n    \"row_pivot\",\n]);\n\n/**\n * Migrate `split_by` field aliases\n */\nconst migrate_split_by = _migrate_field_aliases(\"split_by\", [\n    \"split_by\",\n    \"column_pivots\",\n    \"column-pivot\",\n    \"column-pivots\",\n    \"column_pivot\",\n    \"col_pivots\",\n    \"col-pivot\",\n    \"col-pivots\",\n    \"col_pivot\",\n]);\n\n/**\n * Migrate `filters` field aliases\n */\nconst migrate_filters = _migrate_field_aliases(\"filter\", [\"filter\", \"filters\"]);\n\n/**\n * Migrate the old `computed-columns` format expressions to ExprTK\n * @param regex1\n * @param rep\n * @param expression\n * @param old\n * @param options\n * @returns\n */\nfunction _migrate_expression(regex1, rep, expression, old, options) {\n    if (regex1.test(expression)) {\n        const replaced = expression.replace(regex1, rep);\n        if (options.warn) {\n            console.warn(\n                `Deprecated perspective \"expression\" attribute value \"${expression}\" updated to \"${replaced}\"`\n            );\n        }\n\n        for (const key of [\"group_by\", \"split_by\"]) {\n            if (key in old) {\n                for (const idx in old[key]) {\n                    const pivot = old[key][idx];\n                    if (pivot === expression.replace(/\"/g, \"\")) {\n                        old[key][idx] = replaced;\n                        if (options.warn) {\n                            console.warn(\n                                `Deprecated perspective expression in \"${key}\" attribute \"${expression}\" replaced with \"${replaced}\"`\n                            );\n                        }\n                    }\n                }\n            }\n        }\n\n        for (const filter of old.filter || []) {\n            if (filter[0] === expression.replace(/\"/g, \"\")) {\n                filter[0] = replaced;\n                if (options.warn) {\n                    console.warn(\n                        `Deprecated perspective expression in \"filter\" attribute \"${expression}\" replaced with \"${replaced}\"`\n                    );\n                }\n            }\n        }\n\n        for (const sort of old.sort || []) {\n            if (sort[0] === expression.replace(/\"/g, \"\")) {\n                sort[0] = replaced;\n                if (options.warn) {\n                    console.warn(\n                        `Deprecated perspective expression in \"sort\" attribute \"${expression}\" replaced with \"${replaced}\"`\n                    );\n                }\n            }\n        }\n\n        return replaced;\n    } else {\n        return expression;\n    }\n}\n\nfunction migrate_title(old) {\n    if (old[\"title\"] === undefined) {\n        old.title = null;\n    }\n\n    return old;\n}\n\n/**\n * Migrate `expressions` field from `computed-columns`\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_expressions(old, options) {\n    if (old[\"computed-columns\"]) {\n        if (\"expressions\" in old) {\n            throw new Error(`Duplicate \"expressions\" and \"computed-columns`);\n        }\n\n        old.expressions = old[\"computed-columns\"];\n        delete old[\"computed-columns\"];\n        if (options.warn) {\n            console.warn(\n                `Deprecated perspective attribute \"computed-columns\" renamed \"expressions\"`\n            );\n        }\n\n        const REPLACEMENTS = [\n            [/^year_bucket\\(\"(.+?)\"\\)/, `bucket(\"$1\", 'y')`],\n            [/^month_bucket\\(\"(.+?)\"\\)/, `bucket(\"$1\", 'M')`],\n            [/^day_bucket\\(\"(.+?)\"\\)/, `bucket(\"$1\", 'd')`],\n            [/^hour_bucket\\(\"(.+?)\"\\)/, `bucket(\"$1\", 'h')`],\n            [/^minute_bucket\\(\"(.+?)\"\\)/, `bucket(\"$1\", 'm')`],\n            [/^second_bucket\\(\"(.+?)\"\\)/, `bucket(\"$1\", 's')`],\n        ];\n\n        for (const idx in old.expressions) {\n            let expression = old.expressions[idx];\n            for (const [a, b] of REPLACEMENTS) {\n                expression = _migrate_expression(\n                    a,\n                    b,\n                    expression,\n                    old,\n                    options\n                );\n            }\n\n            old.expressions[idx] = expression;\n        }\n    }\n\n    return old;\n}\n\n/**\n * Migrate the `plugin` field\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_plugins(old, options) {\n    const ALIASES = {\n        datagrid: \"Datagrid\",\n        Datagrid: \"Datagrid\",\n        d3_y_area: \"Y Area\",\n        \"Y Area\": \"Y Area\",\n        d3_y_line: \"Y Line\",\n        \"Y Line\": \"Y Line\",\n        d3_xy_line: \"X/Y Line\",\n        \"X/Y Line\": \"X/Y Line\",\n        d3_y_scatter: \"Y Scatter\",\n        \"Y Scatter\": \"Y Scatter\",\n        d3_xy_scatter: \"X/Y Scatter\",\n        \"X/Y Scatter\": \"X/Y Scatter\",\n        d3_x_bar: \"X Bar\",\n        \"X Bar\": \"X Bar\",\n        d3_y_bar: \"Y Bar\",\n        \"Y Bar\": \"Y Bar\",\n        d3_heatmap: \"Heatmap\",\n        Heatmap: \"Heatmap\",\n        d3_treemap: \"Treemap\",\n        Treemap: \"Treemap\",\n        d3_sunburst: \"Sunburst\",\n        Sunburst: \"Sunburst\",\n    };\n\n    if (\n        \"plugin\" in old &&\n        old.plugin in ALIASES &&\n        old.plugin !== ALIASES[old.plugin]\n    ) {\n        old.plugin = ALIASES[old.plugin];\n        if (options.warn) {\n            console.warn(\n                `Deprecated perspective \"plugin\" attribute value \"${\n                    old.plugin\n                }\" updated to \"${ALIASES[old.plugin]}\"`\n            );\n        }\n    }\n\n    return old;\n}\n\n/**\n * Migrate the `plugin_config` field\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_plugin_config(old, options) {\n    return !!old.plugin_config && old.plugin === \"Datagrid\"\n        ? _migrate_datagrid(old, options)\n        : old;\n}\n\nfunction _migrate_datagrid(old, options) {\n    if (!old.plugin_config.columns) {\n        if (options.warn) {\n            console.warn(\n                `Deprecated perspective attribute \"plugin_config\" moved to \"plugin_config.columns\"`\n            );\n        }\n\n        const columns = {};\n        for (const name of Object.keys(old.plugin_config)) {\n            const column = old.plugin_config[name];\n            delete old.plugin_config[name];\n\n            if (typeof column.color_mode === \"string\") {\n                if (column.color_mode === \"foreground\") {\n                    column.number_fg_mode = \"color\";\n                } else if (column.color_mode === \"bar\") {\n                    column.number_fg_mode = \"bar\";\n                } else if (column.color_mode === \"background\") {\n                    column.number_bg_mode = \"color\";\n                } else if (column.color_mode === \"gradient\") {\n                    column.number_bg_mode = \"gradient\";\n                } else {\n                    console.warn(`Unknown color_mode ${column.color_mode}`);\n                }\n\n                // column.number_color_mode = column.color_mode;\n                delete column[\"color_mode\"];\n\n                if (options.warn) {\n                    console.warn(\n                        `Deprecated perspective attribute \"color_mode\" renamed \"number_bg_mode\"`\n                    );\n                }\n            }\n\n            columns[name] = column;\n        }\n\n        old.plugin_config.columns = columns;\n        if (options.replace_defaults) {\n            old.plugin_config.editable = false;\n            old.plugin_config.scroll_lock = true;\n        }\n    }\n\n    // Post 1.5, number columns have been split between `fg` and `bg`\n    // style param contexts.\n    for (const name of Object.keys(old.plugin_config.columns)) {\n        const column = old.plugin_config.columns[name];\n\n        if (typeof column.number_color_mode === \"string\") {\n            if (column.number_color_mode === \"foreground\") {\n                column.number_fg_mode = \"color\";\n            } else if (column.number_color_mode === \"bar\") {\n                column.number_fg_mode = \"bar\";\n            } else if (column.number_color_mode === \"background\") {\n                column.number_bg_mode = \"color\";\n            } else if (column.number_color_mode === \"gradient\") {\n                column.number_bg_mode = \"gradient\";\n            }\n\n            delete column[\"number_color_mode\"];\n\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective attribute \"number_color_mode\" renamed \"number_bg_mode\"`\n                );\n            }\n        }\n\n        if (column.gradient !== undefined) {\n            if (column.number_bg_mode === \"gradient\") {\n                column.bg_gradient = column.gradient;\n            } else if (column.number_fg_mode === \"bar\") {\n                column.fg_gradient = column.gradient;\n            }\n\n            delete column[\"gradient\"];\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective attribute \"gradient\" renamed \"bg_gradient\"`\n                );\n            }\n        }\n\n        if (column.pos_color !== undefined) {\n            if (column.number_bg_mode !== undefined) {\n                column.pos_bg_color = column.pos_color;\n            } else if (column.number_fg_mode !== undefined) {\n                column.pos_fg_color = column.pos_color;\n            }\n\n            delete column[\"pos_color\"];\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective attribute \"pos_color\" renamed \"pos_bg_color\"`\n                );\n            }\n        }\n\n        if (column.neg_color !== undefined) {\n            if (column.number_bg_mode !== undefined) {\n                column.neg_bg_color = column.neg_color;\n            } else if (column.number_fg_mode !== undefined) {\n                column.neg_fg_color = column.neg_color;\n            }\n\n            delete column[\"neg_color\"];\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective attribute \"neg_color\" renamed \"neg_bg_color\"`\n                );\n            }\n        }\n    }\n\n    return old;\n}\n\n/**\n * Migrate attributes which were once persisted but are now considered errors\n * in `<perspective-viewer>` and should only be set in HTML\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_attributes_viewer(old, options) {\n    const ATTRIBUTES = [\n        \"editable\",\n        \"selectable\",\n        \"name\",\n        \"table\",\n        \"master\",\n        \"linked\",\n    ];\n    for (const attr of ATTRIBUTES) {\n        if (attr in old) {\n            delete old[attr];\n\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective attribute \"${attr}\" removed`\n                );\n            }\n        }\n    }\n\n    return old;\n}\n\n/**\n * Migrate attributes which were once persisted but are now considered errors\n * in `<perspective-workspace>` and should only be set in HTML\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_attributes_workspace(old, options) {\n    const ATTRIBUTES = [\n        \"editable\",\n        \"selectable\",\n        \"name\",\n        \"table\",\n        \"master\",\n        \"linked\",\n    ];\n    for (const attr of ATTRIBUTES) {\n        if (attr in old && old[attr] === null) {\n            delete old[attr];\n\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective attribute \"${attr}\" removed`\n                );\n            }\n        }\n    }\n\n    return old;\n}\n\n/**\n * Migrate workspace viewer 'name' which was unified with `title`.\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_name_title_workspace(old, options) {\n    if (\"name\" in old) {\n        if (\"title\" in old && old.title !== undefined) {\n            old.title = old[\"name\"];\n            if (options.warn) {\n                console.warn(`\"name\" conflicts with \"title\"`);\n            }\n        }\n\n        delete old[\"name\"];\n\n        if (options.warn) {\n            console.warn(`\"name\" unified with \"title\"`);\n        }\n    }\n\n    return old;\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport { ViewConfig } from \"@finos/perspective\";\nimport Semver from \"./semver\";\nimport { Options } from \"../migrate\";\n\n/**\n * Migrates from 2.6.1\n * @param old\n * @param options\n * @returns\n */\nexport default function migrate_2_6_1(old: any, options: Options) {\n    let next_version = options.version_chain.shift();\n    if (old.version?.gt(next_version)) {\n        return old;\n    } else if (options.warn) {\n        console.warn(`Migrating 2.6.1 -> ${next_version}`);\n    }\n    old.version = new Semver(next_version);\n\n    // Migrate X/Y Scatter plugin\n    if (\n        old.plugin === \"X/Y Scatter\" &&\n        typeof old.plugin_config?.columns === \"object\"\n    ) {\n        for (const i in old.plugin_config.columns) {\n            const entries = Object.entries(old.plugin_config.columns[i]);\n            const mapped_entries = entries.map(([grp_name, grp_val]) => {\n                if (grp_name === \"symbols\" && Array.isArray(grp_val)) {\n                    if (options.warn) {\n                        console.warn(\n                            `Replacing depcrecated X/Y Scatter Plot symbol config ${grp_val}`\n                        );\n                    }\n                    const obj = {};\n                    for (const i in grp_val) {\n                        const item = grp_val[i];\n                        obj[item.key] = item.value;\n                    }\n                    grp_val = obj;\n                }\n                return [grp_name, grp_val];\n            });\n            old.plugin_config.columns[i] = Object.fromEntries(mapped_entries);\n        }\n    }\n\n    // check for string expressions, replace with objects\n    if (Array.isArray(old.expressions)) {\n        let new_exprs = {};\n        for (let i in old.expressions) {\n            if (typeof old.expressions[i] === \"string\") {\n                if (options.warn) {\n                    console.warn(\n                        \"Replacing deprecated string expression with object\"\n                    );\n                }\n                let old_expr = old.expressions[i];\n                let [whole_expr, name, expr] = old_expr.match(\n                    /\\/\\/\\s*([^\\n]+)\\n(.*)/\n                ) ?? [old_expr, null, null];\n                if (name && expr) {\n                    new_exprs[name] = expr;\n                } else {\n                    new_exprs[whole_expr] = whole_expr;\n                }\n            }\n        }\n        old.expressions = new_exprs;\n    }\n\n    if (options.verbose) {\n        console.log(old);\n    }\n    return old;\n}\n\nexport type Config261 = ViewConfig & {\n    version: Semver;\n    plugin?: string;\n    settings?: boolean;\n    plugin_config?: any;\n};\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport Semver from \"./semver\";\nimport { Options } from \"../migrate\";\nimport { Config261 } from \"./2-6-1\";\nimport {\n    PerspectiveColumnConfig,\n    PerspectiveColumnConfigValue,\n} from \"../perspective-viewer\";\n\n/**\n * Migrates from 2.7.1. Focus is on plugin API changes, moving plugin_config.columns to columns_config\n * @param old\n * @param options\n * @returns\n */\nexport default function migrate_2_7_1(old: Config271, options: Options) {\n    let next_version = options.version_chain.shift();\n    if (old.version?.gt(next_version!)) {\n        return old;\n    } else if (options.warn) {\n        console.warn(`Migrating 2.7.1 -> ${next_version}`);\n    }\n    old.version = new Semver(next_version!);\n\n    old.columns_config = old.columns_config ?? {};\n\n    const has_config = !!old.plugin_config?.columns;\n    const has_plugin =\n        old.plugin === \"Datagrid\" || old.plugin === \"X/Y Scatter\";\n    if (has_config && has_plugin) {\n        if (options.warn) {\n            console.warn(\"Migrating plugin_config to columns_config!\");\n        }\n\n        old.columns_config = old.columns_config ?? {};\n        let entries = Object.entries(old.plugin_config.columns);\n        for (let [column_name, value_map] of entries) {\n            old.columns_config[column_name] =\n                old.columns_config[column_name] ?? {};\n\n            if (old.plugin === \"X/Y Scatter\") {\n                old.columns_config[column_name].symbols =\n                    old.plugin_config.columns[column_name]?.symbols ?? {};\n                delete old.plugin_config.columns[column_name];\n            } else {\n                const cwo =\n                    old.plugin_config.columns[column_name]\n                        .column_width_override;\n                delete old.plugin_config.columns[column_name]\n                    .column_width_override;\n                for (const [key, val] of Object.entries(value_map)) {\n                    switch (key) {\n                        case \"format\":\n                            if (val !== \"custom\") {\n                                break;\n                            }\n                        case \"timeZone\":\n                        case \"fractionalSecondDigits\":\n                        case \"second\":\n                        case \"minute\":\n                        case \"hour\":\n                        case \"day\":\n                        case \"weekday\":\n                        case \"month\":\n                        case \"year\":\n                        case \"hour12\":\n                        case \"dateStyle\":\n                        case \"timeStyle\": {\n                            old.columns_config[column_name] =\n                                old.columns_config[column_name] ?? {};\n                            old.columns_config[column_name].date_format =\n                                old.columns_config[column_name].date_format ??\n                                {};\n                            old.columns_config[column_name].date_format[key] =\n                                val;\n                            delete old.plugin_config.columns[column_name][key];\n                            continue;\n                        }\n                        case \"fixed\": {\n                            old.columns_config[column_name] =\n                                old.columns_config[column_name] ?? {};\n\n                            old.columns_config[column_name].number_format =\n                                old.columns_config[column_name].number_format ??\n                                {};\n\n                            old.columns_config[\n                                column_name\n                            ].number_format.minimumFractionDigits = val;\n\n                            old.columns_config[\n                                column_name\n                            ].number_format.maximumFractionDigits = val;\n\n                            delete old.plugin_config.columns[column_name][key];\n                            continue;\n                        }\n                        default: {\n                        }\n                    }\n\n                    old.columns_config[column_name] =\n                        old.columns_config[column_name] ?? {};\n                    old.columns_config[column_name][key] = val;\n                    delete old.plugin_config.columns[column_name][key];\n                }\n\n                if (!!cwo) {\n                    old.plugin_config.columns[column_name] = {\n                        column_width_override: cwo,\n                    };\n                } else {\n                    delete old.plugin_config.columns[column_name];\n                }\n            }\n        }\n\n        if (\n            old.plugin === \"X/Y Scatter\" &&\n            Object.keys(old.plugin_config?.columns).length === 0\n        ) {\n            delete old.plugin_config?.columns;\n        }\n    }\n\n    if (options.verbose) {\n        console.log(old);\n    }\n    return old;\n}\n\nexport type Config271 = Config261 & {\n    columns_config?: PerspectiveColumnConfig;\n};\n"],
  "mappings": "4ZAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,WAAAE,EAAA,YAAAC,IAAA,eAAAC,EAAAJ,GCYA,SAAUK,GAAY,CAClB,OAAa,MAAM,IACvB,CACA,IAAqBC,EAArB,KAA4B,CAUxB,YAAYC,EAAsB,CAC9B,GAAI,OAAOA,GAAQ,SACf,YAAK,MAAQA,EAAI,MACjB,KAAK,MAAQA,EAAI,MACjB,KAAK,MAAQA,EAAI,MACjB,KAAK,MAAQA,EAAI,MACV,KAGX,IAAIC,EAAQ,6BACR,CAACC,EAAMC,EAAOC,EAAOC,EAAOC,CAAS,EAAIN,EAAI,MAAMC,CAAK,EACxD,CAACM,EAAQC,EAAaC,EAAaC,CAAW,EAC9CJ,GAAW,MAAML,CAAK,GAAKH,EAAU,EACrCa,EACAH,GAAeC,GAAeC,EACxB,CACI,MAAO,OAAOF,CAAW,EACzB,MAAO,OAAOC,CAAW,EACzB,MAAO,OAAOC,CAAW,CAC7B,EACA,KAEV,YAAK,MAAQ,OAAOP,CAAK,EACzB,KAAK,MAAQ,OAAOC,CAAK,EACzB,KAAK,MAAQ,OAAOC,CAAK,EACzB,KAAK,MAAQM,EACN,IACX,CAEA,WAAY,CACR,MAAO,GAAG,KAAK,SAAS,KAAK,SAAS,KAAK,OAC/C,CAEA,GAAGC,EAAsB,CACrB,IAAIC,EAAQ,IAAId,EAAOa,CAAG,EAC1B,OACI,KAAK,MAAQC,EAAM,OAClB,KAAK,QAAUA,EAAM,OAAS,KAAK,MAAQA,EAAM,OACjD,KAAK,QAAUA,EAAM,OAClB,KAAK,QAAUA,EAAM,OACrB,KAAK,MAAQA,EAAM,KAE/B,CACA,GAAGD,EAAsB,CACrB,IAAIC,EAAQ,IAAId,EAAOa,CAAG,EAC1B,OACI,KAAK,QAAUC,EAAM,OACrB,KAAK,OAASA,EAAM,OACpB,KAAK,OAASA,EAAM,KAE5B,CAEA,GAAGD,EAAsB,CACrB,IAAIC,EAAQ,IAAId,EAAOa,CAAG,EAC1B,OAAO,KAAK,GAAGC,CAAK,GAAK,KAAK,GAAGA,CAAK,CAC1C,CACJ,EC3De,SAARC,EAA+BC,EAAUC,EAAkB,CAC9D,IAAMC,EAAeD,EAAQ,cAAc,MAAM,EACjD,GAAID,EAAI,SAAS,GAAGE,CAAY,EAC5B,OAAOF,EAEHC,EAAQ,MACR,QAAQ,KAAK,uBAAuBC,GAAc,EAG1D,IAAIC,EAAMC,EACNJ,EACA,CACIK,EACAC,EACAC,EACAC,EACAP,EAAQ,iBAAmBQ,EAAiBC,GAAMA,EAClDC,EACAC,EACAC,EACAC,EACAb,EAAQ,gBACFc,EACAC,EACLhB,IACGA,EAAI,QAAU,IAAIiB,EAAO,OAAO,EACzBjB,EAEf,EACAC,CACJ,EAEA,OAAIA,EAAQ,SACR,QAAQ,IAAIE,CAAG,EAEZA,CACX,CAYA,SAASM,EAAcT,EAAKC,EAAS,CACjC,QAAWiB,IAAO,CAAC,WAAY,WAAY,SAAU,MAAM,EACnDlB,EAAIkB,KAAS,OACblB,EAAIkB,GAAO,CAAC,EACRjB,EAAQ,MACR,QAAQ,KACJ,6CAA6CiB,oBACjD,GAIJ,eAAgBlB,GAAOA,EAAI,aAAe,OAC1CA,EAAI,WAAa,CAAC,EACdC,EAAQ,MACR,QAAQ,KACJ,uEACJ,GAKZ,OAAOD,CACX,CAQA,SAASmB,EAAuBC,EAAUC,EAAS,CAC/C,OAAO,SAAUrB,EAAKC,EAAS,CAC3B,IAAIqB,EAAQ,EACZ,QAAWC,KAASF,EAChB,GAAIE,KAASvB,EAAK,CACd,GAAIsB,IAAU,EACV,MAAM,IAAI,MAAM,cAAcF,WAAkB,EAGpDpB,EAAIoB,GAAYpB,EAAIuB,GAChBA,IAAUH,IACV,OAAOpB,EAAIuB,GACPtB,EAAQ,MACR,QAAQ,KACJ,qCAAqCsB,eAAmBH,IAC5D,EAGZ,CAGJ,OAAOpB,CACX,CACJ,CAKA,IAAMK,EAAmBc,EAAuB,WAAY,CACxD,WACA,aACA,YACA,aACA,WACJ,CAAC,EAKKb,EAAmBa,EAAuB,WAAY,CACxD,WACA,gBACA,eACA,gBACA,eACA,aACA,YACA,aACA,WACJ,CAAC,EAKKZ,EAAkBY,EAAuB,SAAU,CAAC,SAAU,SAAS,CAAC,EAW9E,SAASK,EAAoBC,EAAQC,EAAKC,EAAY3B,EAAKC,EAAS,CAChE,GAAIwB,EAAO,KAAKE,CAAU,EAAG,CACzB,IAAMC,EAAWD,EAAW,QAAQF,EAAQC,CAAG,EAC3CzB,EAAQ,MACR,QAAQ,KACJ,wDAAwD0B,kBAA2BC,IACvF,EAGJ,QAAWV,IAAO,CAAC,WAAY,UAAU,EACrC,GAAIA,KAAOlB,EACP,QAAW6B,KAAO7B,EAAIkB,GACJlB,EAAIkB,GAAKW,KACTF,EAAW,QAAQ,KAAM,EAAE,IACrC3B,EAAIkB,GAAKW,GAAOD,EACZ3B,EAAQ,MACR,QAAQ,KACJ,yCAAyCiB,iBAAmBS,qBAA8BC,IAC9F,GAOpB,QAAWE,KAAU9B,EAAI,QAAU,CAAC,EAC5B8B,EAAO,KAAOH,EAAW,QAAQ,KAAM,EAAE,IACzCG,EAAO,GAAKF,EACR3B,EAAQ,MACR,QAAQ,KACJ,4DAA4D0B,qBAA8BC,IAC9F,GAKZ,QAAWG,KAAQ/B,EAAI,MAAQ,CAAC,EACxB+B,EAAK,KAAOJ,EAAW,QAAQ,KAAM,EAAE,IACvCI,EAAK,GAAKH,EACN3B,EAAQ,MACR,QAAQ,KACJ,0DAA0D0B,qBAA8BC,IAC5F,GAKZ,OAAOA,CACX,KACI,QAAOD,CAEf,CAEA,SAASd,EAAcb,EAAK,CACxB,OAAIA,EAAI,QAAa,SACjBA,EAAI,MAAQ,MAGTA,CACX,CAQA,SAASQ,EAAoBR,EAAKC,EAAS,CACvC,GAAID,EAAI,oBAAqB,CACzB,GAAI,gBAAiBA,EACjB,MAAM,IAAI,MAAM,+CAA+C,EAGnEA,EAAI,YAAcA,EAAI,oBACtB,OAAOA,EAAI,oBACPC,EAAQ,MACR,QAAQ,KACJ,2EACJ,EAGJ,IAAM+B,EAAe,CACjB,CAAC,0BAA2B,mBAAmB,EAC/C,CAAC,2BAA4B,mBAAmB,EAChD,CAAC,yBAA0B,mBAAmB,EAC9C,CAAC,0BAA2B,mBAAmB,EAC/C,CAAC,4BAA6B,mBAAmB,EACjD,CAAC,4BAA6B,mBAAmB,CACrD,EAEA,QAAWH,KAAO7B,EAAI,YAAa,CAC/B,IAAI2B,EAAa3B,EAAI,YAAY6B,GACjC,OAAW,CAACI,EAAGC,CAAC,IAAKF,EACjBL,EAAaH,EACTS,EACAC,EACAP,EACA3B,EACAC,CACJ,EAGJD,EAAI,YAAY6B,GAAOF,CAC3B,CACJ,CAEA,OAAO3B,CACX,CAQA,SAASW,EAAgBX,EAAKC,EAAS,CACnC,IAAMkC,EAAU,CACZ,SAAU,WACV,SAAU,WACV,UAAW,SACX,SAAU,SACV,UAAW,SACX,SAAU,SACV,WAAY,WACZ,WAAY,WACZ,aAAc,YACd,YAAa,YACb,cAAe,cACf,cAAe,cACf,SAAU,QACV,QAAS,QACT,SAAU,QACV,QAAS,QACT,WAAY,UACZ,QAAS,UACT,WAAY,UACZ,QAAS,UACT,YAAa,WACb,SAAU,UACd,EAEA,MACI,WAAYnC,GACZA,EAAI,UAAUmC,GACdnC,EAAI,SAAWmC,EAAQnC,EAAI,UAE3BA,EAAI,OAASmC,EAAQnC,EAAI,QACrBC,EAAQ,MACR,QAAQ,KACJ,oDACID,EAAI,uBACSmC,EAAQnC,EAAI,UACjC,GAIDA,CACX,CAQA,SAASY,EAAsBZ,EAAKC,EAAS,CACzC,MAAO,CAAC,CAACD,EAAI,eAAiBA,EAAI,SAAW,WACvCoC,EAAkBpC,EAAKC,CAAO,EAC9BD,CACV,CAEA,SAASoC,EAAkBpC,EAAKC,EAAS,CACrC,GAAI,CAACD,EAAI,cAAc,QAAS,CACxBC,EAAQ,MACR,QAAQ,KACJ,mFACJ,EAGJ,IAAMoC,EAAU,CAAC,EACjB,QAAWC,KAAQ,OAAO,KAAKtC,EAAI,aAAa,EAAG,CAC/C,IAAMuC,EAASvC,EAAI,cAAcsC,GACjC,OAAOtC,EAAI,cAAcsC,GAErB,OAAOC,EAAO,YAAe,WACzBA,EAAO,aAAe,aACtBA,EAAO,eAAiB,QACjBA,EAAO,aAAe,MAC7BA,EAAO,eAAiB,MACjBA,EAAO,aAAe,aAC7BA,EAAO,eAAiB,QACjBA,EAAO,aAAe,WAC7BA,EAAO,eAAiB,WAExB,QAAQ,KAAK,sBAAsBA,EAAO,YAAY,EAI1D,OAAOA,EAAO,WAEVtC,EAAQ,MACR,QAAQ,KACJ,wEACJ,GAIRoC,EAAQC,GAAQC,CACpB,CAEAvC,EAAI,cAAc,QAAUqC,EACxBpC,EAAQ,mBACRD,EAAI,cAAc,SAAW,GAC7BA,EAAI,cAAc,YAAc,GAExC,CAIA,QAAWsC,KAAQ,OAAO,KAAKtC,EAAI,cAAc,OAAO,EAAG,CACvD,IAAMuC,EAASvC,EAAI,cAAc,QAAQsC,GAErC,OAAOC,EAAO,mBAAsB,WAChCA,EAAO,oBAAsB,aAC7BA,EAAO,eAAiB,QACjBA,EAAO,oBAAsB,MACpCA,EAAO,eAAiB,MACjBA,EAAO,oBAAsB,aACpCA,EAAO,eAAiB,QACjBA,EAAO,oBAAsB,aACpCA,EAAO,eAAiB,YAG5B,OAAOA,EAAO,kBAEVtC,EAAQ,MACR,QAAQ,KACJ,+EACJ,GAIJsC,EAAO,WAAa,SAChBA,EAAO,iBAAmB,WAC1BA,EAAO,YAAcA,EAAO,SACrBA,EAAO,iBAAmB,QACjCA,EAAO,YAAcA,EAAO,UAGhC,OAAOA,EAAO,SACVtC,EAAQ,MACR,QAAQ,KACJ,mEACJ,GAIJsC,EAAO,YAAc,SACjBA,EAAO,iBAAmB,OAC1BA,EAAO,aAAeA,EAAO,UACtBA,EAAO,iBAAmB,SACjCA,EAAO,aAAeA,EAAO,WAGjC,OAAOA,EAAO,UACVtC,EAAQ,MACR,QAAQ,KACJ,qEACJ,GAIJsC,EAAO,YAAc,SACjBA,EAAO,iBAAmB,OAC1BA,EAAO,aAAeA,EAAO,UACtBA,EAAO,iBAAmB,SACjCA,EAAO,aAAeA,EAAO,WAGjC,OAAOA,EAAO,UACVtC,EAAQ,MACR,QAAQ,KACJ,qEACJ,EAGZ,CAEA,OAAOD,CACX,CASA,SAASgB,EAA0BhB,EAAKC,EAAS,CAC7C,IAAMuC,EAAa,CACf,WACA,aACA,OACA,QACA,SACA,QACJ,EACA,QAAWC,KAAQD,EACXC,KAAQzC,IACR,OAAOA,EAAIyC,GAEPxC,EAAQ,MACR,QAAQ,KACJ,qCAAqCwC,YACzC,GAKZ,OAAOzC,CACX,CASA,SAASe,EAA6Bf,EAAKC,EAAS,CAChD,IAAMuC,EAAa,CACf,WACA,aACA,OACA,QACA,SACA,QACJ,EACA,QAAWC,KAAQD,EACXC,KAAQzC,GAAOA,EAAIyC,KAAU,OAC7B,OAAOzC,EAAIyC,GAEPxC,EAAQ,MACR,QAAQ,KACJ,qCAAqCwC,YACzC,GAKZ,OAAOzC,CACX,CAQA,SAASc,EAA6Bd,EAAKC,EAAS,CAChD,MAAI,SAAUD,IACN,UAAWA,GAAOA,EAAI,QAAU,SAChCA,EAAI,MAAQA,EAAI,KACZC,EAAQ,MACR,QAAQ,KAAK,+BAA+B,GAIpD,OAAOD,EAAI,KAEPC,EAAQ,MACR,QAAQ,KAAK,6BAA6B,GAI3CD,CACX,CCvgBe,SAAR0C,EAA+BC,EAAUC,EAAkB,CAC9D,IAAIC,EAAeD,EAAQ,cAAc,MAAM,EAC/C,GAAID,EAAI,SAAS,GAAGE,CAAY,EAC5B,OAAOF,EAOX,GANWC,EAAQ,MACf,QAAQ,KAAK,sBAAsBC,GAAc,EAErDF,EAAI,QAAU,IAAIG,EAAOD,CAAY,EAIjCF,EAAI,SAAW,eACf,OAAOA,EAAI,eAAe,SAAY,SAEtC,QAAWI,KAAKJ,EAAI,cAAc,QAAS,CAEvC,IAAMK,EADU,OAAO,QAAQL,EAAI,cAAc,QAAQI,EAAE,EAC5B,IAAI,CAAC,CAACE,EAAUC,CAAO,IAAM,CACxD,GAAID,IAAa,WAAa,MAAM,QAAQC,CAAO,EAAG,CAC9CN,EAAQ,MACR,QAAQ,KACJ,wDAAwDM,GAC5D,EAEJ,IAAMC,EAAM,CAAC,EACb,QAAWJ,KAAKG,EAAS,CACrB,IAAME,EAAOF,EAAQH,GACrBI,EAAIC,EAAK,KAAOA,EAAK,KACzB,CACAF,EAAUC,CACd,CACA,MAAO,CAACF,EAAUC,CAAO,CAC7B,CAAC,EACDP,EAAI,cAAc,QAAQI,GAAK,OAAO,YAAYC,CAAc,CACpE,CAIJ,GAAI,MAAM,QAAQL,EAAI,WAAW,EAAG,CAChC,IAAIU,EAAY,CAAC,EACjB,QAAS,KAAKV,EAAI,YACd,GAAI,OAAOA,EAAI,YAAY,IAAO,SAAU,CACpCC,EAAQ,MACR,QAAQ,KACJ,oDACJ,EAEJ,IAAIU,EAAWX,EAAI,YAAY,GAC3B,CAACY,EAAYC,EAAMC,CAAI,EAAIH,EAAS,MACpC,uBACJ,GAAK,CAACA,EAAU,KAAM,IAAI,EACtBE,GAAQC,EACRJ,EAAUG,GAAQC,EAElBJ,EAAUE,GAAcA,CAEhC,CAEJZ,EAAI,YAAcU,CACtB,CAEA,OAAIT,EAAQ,SACR,QAAQ,IAAID,CAAG,EAEZA,CACX,CC5De,SAARe,EAA+BC,EAAgBC,EAAkB,CACpE,IAAIC,EAAeD,EAAQ,cAAc,MAAM,EAC/C,GAAID,EAAI,SAAS,GAAGE,CAAa,EAC7B,OAAOF,EACAC,EAAQ,MACf,QAAQ,KAAK,sBAAsBC,GAAc,EAErDF,EAAI,QAAU,IAAIG,EAAOD,CAAa,EAEtCF,EAAI,eAAiBA,EAAI,gBAAkB,CAAC,EAE5C,IAAMI,EAAa,CAAC,CAACJ,EAAI,eAAe,QAClCK,EACFL,EAAI,SAAW,YAAcA,EAAI,SAAW,cAChD,GAAII,GAAcC,EAAY,CACtBJ,EAAQ,MACR,QAAQ,KAAK,4CAA4C,EAG7DD,EAAI,eAAiBA,EAAI,gBAAkB,CAAC,EAC5C,IAAIM,EAAU,OAAO,QAAQN,EAAI,cAAc,OAAO,EACtD,OAAS,CAACO,EAAaC,CAAS,IAAKF,EAIjC,GAHAN,EAAI,eAAeO,GACfP,EAAI,eAAeO,IAAgB,CAAC,EAEpCP,EAAI,SAAW,cACfA,EAAI,eAAeO,GAAa,QAC5BP,EAAI,cAAc,QAAQO,IAAc,SAAW,CAAC,EACxD,OAAOP,EAAI,cAAc,QAAQO,OAC9B,CACH,IAAME,EACFT,EAAI,cAAc,QAAQO,GACrB,sBACT,OAAOP,EAAI,cAAc,QAAQO,GAC5B,sBACL,OAAW,CAACG,EAAKC,CAAG,IAAK,OAAO,QAAQH,CAAS,EAAG,CAChD,OAAQE,OACC,SACD,GAAIC,IAAQ,SACR,UAEH,eACA,6BACA,aACA,aACA,WACA,UACA,cACA,YACA,WACA,aACA,gBACA,YAAa,CACdX,EAAI,eAAeO,GACfP,EAAI,eAAeO,IAAgB,CAAC,EACxCP,EAAI,eAAeO,GAAa,YAC5BP,EAAI,eAAeO,GAAa,aAChC,CAAC,EACLP,EAAI,eAAeO,GAAa,YAAYG,GACxCC,EACJ,OAAOX,EAAI,cAAc,QAAQO,GAAaG,GAC9C,QACJ,KACK,QAAS,CACVV,EAAI,eAAeO,GACfP,EAAI,eAAeO,IAAgB,CAAC,EAExCP,EAAI,eAAeO,GAAa,cAC5BP,EAAI,eAAeO,GAAa,eAChC,CAAC,EAELP,EAAI,eACAO,GACF,cAAc,sBAAwBI,EAExCX,EAAI,eACAO,GACF,cAAc,sBAAwBI,EAExC,OAAOX,EAAI,cAAc,QAAQO,GAAaG,GAC9C,QACJ,UAKJV,EAAI,eAAeO,GACfP,EAAI,eAAeO,IAAgB,CAAC,EACxCP,EAAI,eAAeO,GAAaG,GAAOC,EACvC,OAAOX,EAAI,cAAc,QAAQO,GAAaG,EAClD,CAEMD,EACFT,EAAI,cAAc,QAAQO,GAAe,CACrC,sBAAuBE,CAC3B,EAEA,OAAOT,EAAI,cAAc,QAAQO,EAEzC,CAIAP,EAAI,SAAW,eACf,OAAO,KAAKA,EAAI,eAAe,OAAO,EAAE,SAAW,GAEnD,OAAOA,EAAI,eAAe,OAElC,CAEA,OAAIC,EAAQ,SACR,QAAQ,IAAID,CAAG,EAEZA,CACX;;;;;ubJzHA,IAAMY,EAAcC,EAAY,QA4CzB,SAASC,EACZC,EACA,CACI,KAAAC,EAAO,GACP,QAAAC,EAAU,GACV,iBAAAC,EAAmB,EACvB,EAA+B,CAAC,EACc,CAC9C,GAAI,OAAOH,GAAQ,UAAY,EAAEA,aAAe,aAAc,CAC1D,IAAMI,EAAO,KAAK,MAAM,KAAK,UAAUJ,CAAG,CAAC,EACvCK,EAAU,CACV,KAAMH,EAAU,GAAOD,EACvB,QAAAC,EACA,iBAAAC,CACJ,EACA,MAAI,YAAaC,GAAQ,WAAYA,EAC1BE,EAAkBF,EAAMC,CAAO,EAE/BE,EAAeH,EAAM,GAAOC,CAAO,CAElD,KACI,QAAOL,CAEf,CAmBA,SAASM,EAAkBN,EAAUK,EAAkB,CACnD,QAAWG,KAAOR,EAAI,QAClBA,EAAI,QAAQQ,GAAOD,EAAeP,EAAI,QAAQQ,GAAM,GAAMH,CAAO,EAC3D,WAAYL,EAAI,QAAQQ,KAC1BR,EAAI,QAAQQ,GAAK,OAAS,GACtBH,EAAQ,MACR,QAAQ,KACJ,kEACJ,GAIF,WAAYL,EAAI,QAAQQ,KAC1BR,EAAI,QAAQQ,GAAK,OAAS,GACtBH,EAAQ,MACR,QAAQ,KACJ,kEACJ,GAKZ,OAAOL,CACX,CAQA,SAASO,EAAeP,EAAUS,EAA0BJ,EAAkB,CAC1EL,EAAI,QAAUA,EAAI,QAAU,IAAIU,EAAOV,EAAI,OAAO,EAAI,IAAIU,EAAO,OAAO,EACxEL,EAAQ,gBAAkBI,EAQ1BJ,EAAQ,cAAgB,CAAC,QAAS,QAAS,OAAO,EAClDA,EAAQ,cAAc,KAAKR,CAAW,EACtC,IAAIc,EAAMC,EACNZ,EACA,CACIa,EACAC,EACAC,EACAC,EACChB,IACU,CACH,GAAGA,EACH,QAASA,EAAI,QAAQ,UAAU,CACnC,EAER,EACAK,CACJ,EACA,OAAIA,EAAQ,SACR,QAAQ,IAAI,mBAAoBM,CAAG,EAEhCA,CACX,CAEA,SAASK,EAAchB,EAA0B,CAC7C,GAAIA,EAAI,QAAQ,GAAGH,CAAW,EAC1B,MAAM,IAAI,MAAM,iDAAiD,EAEjE,OAAAG,EAAI,QAAU,IAAIU,EAAOb,CAAW,EAC7BG,CAEf,CASO,SAASY,EAAMZ,EAAaiB,EAAkBZ,EAAkB,CACnE,QAAWa,KAAOD,EACdjB,EAAMkB,EAAIlB,EAAKK,CAAO,EAG1B,OAAOL,CACX",
  "names": ["migrate_exports", "__export", "chain", "convert", "__toCommonJS", "null_iter", "Semver", "ver", "regex", "_ver", "major", "minor", "patch", "build_str", "_build", "build_major", "build_minor", "build_patch", "build", "val", "right", "migrate_0_0_0", "old", "options", "next_version", "res", "chain", "migrate_group_by", "migrate_split_by", "migrate_filters", "migrate_expressions", "migrate_nulls", "x", "migrate_plugins", "migrate_plugin_config", "migrate_title", "migrate_name_title_workspace", "migrate_attributes_workspace", "migrate_attributes_viewer", "Semver", "key", "_migrate_field_aliases", "original", "aliases", "count", "pivot", "_migrate_expression", "regex1", "rep", "expression", "replaced", "idx", "filter", "sort", "REPLACEMENTS", "a", "b", "ALIASES", "_migrate_datagrid", "columns", "name", "column", "ATTRIBUTES", "attr", "migrate_2_6_1", "old", "options", "next_version", "Semver", "i", "mapped_entries", "grp_name", "grp_val", "obj", "item", "new_exprs", "old_expr", "whole_expr", "name", "expr", "migrate_2_7_1", "old", "options", "next_version", "Semver", "has_config", "has_plugin", "entries", "column_name", "value_map", "cwo", "key", "val", "PKG_VERSION", "package_default", "convert", "old", "warn", "verbose", "replace_defaults", "copy", "options", "migrate_workspace", "migrate_viewer", "key", "omit_attributes", "Semver", "res", "chain", "migrate_0_0_0", "migrate_2_6_1", "migrate_2_7_1", "assure_latest", "args", "arg"]
}
